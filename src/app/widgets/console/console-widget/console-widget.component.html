<div class="console-widget-main">
    <div class="console-widget-api">
        <!-- API: PROBLEMS and SERVICES -->
        <div class="console-widget-api-row console-widget-api-problem">
            <button pButton class="p-button-danger" icon="pi pi-refresh"
                            title="Refresh" pTooltip="Refresh"
                            (click)="reloadProblemList()"></button>
            <p-dropdown placeholder="Seleziona un problema" class="console-widget-problem-selector" 
                        [options]="servicesMenu" [group]="false" [(ngModel)]="selectedService"
                        (onChange)="didSelectService()" [style]="{'height': '55px', 'padding': 0}">

                  <ng-template let-group pTemplate="group">
                      <div class="console-widget-problem-group">
                      </div>
                  </ng-template>

                  <ng-template let-option pTemplate="selectedItem">
                    <div class="console-widget-problem-selected">
                      <span class="problem-label">{{option.problem}}</span>
                      <span class="service-label">{{option.service}}</span>
                    </div>
                  </ng-template>

                  <ng-template let-option pTemplate="item">
                    <div class="console-widget-problem-item">
                      <span class="problem-label">{{option.problem}}</span>
                      <span class="service-label">{{option.service}}</span>
                    </div>
                  </ng-template>

            </p-dropdown>
            <button pButton class="p-button-help" icon="pi pi-download" (click)="apiDownloadAttachment()"
                    title="Download Attachments" pTooltip="Scarica allegati"></button>
        </div>

        <!-- API: ARGS -->
        <div class="console-widget-api-row console-widget-api-args">
            <div class="console-widget-api-args-row" *ngIf="selectedArgs && selectedArgs!.size>0">
              <div class="console-widget-api-args-row-title">Params</div>
            </div>

            <div class="console-widget-api-args-row" *ngFor="let arg of selectedArgs | keyvalue">
              
              <!-- info -->
              <div class="console-widget-api-args-row-info">
                <i class="pi pi-info-circle" [pTooltip]="'Validation:' + arg.value.regex"></i>
              </div>
              <!-- name -->
              <div class="console-widget-api-args-row-name">{{arg.value.name}}</div>

              <!-- field -->
              <div class="console-widget-api-args-row-field">
                <input pInputText type="text" class="top-bar-url-input p-inputtext-sm"
                  [placeholder]="arg.value.default" [(ngModel)]="arg.value.value"
                  (change)="argDidChange(arg.value.key,$event)">  
              </div>

              <!-- field -->
              <div class="console-widget-api-args-row-actions">
                <button pButton class="p-button" icon="pi pi-trash" (click)="argDidReset(arg.value.key,$event)"
                  title="Reset to default" pTooltip="Reset to default"></button>
              </div>
            </div>
        </div>

    </div>
    


    <p-splitter class="console-widget-splitter" [style]="{'width': '100%'}" 
                layout="vertical" [panelSizes]="[1,1]" [minSizes]="[0,0]">


      <ng-template pTemplate>
        <div class="console-widget-terminal">

          <!-- <div id="xterm-container"></div> -->
          <div class="console-widget-label">Terminal</div>
          <div class="console-widget-terminal-scroll">
            <p-terminal class="console-widget-terminal-shell" #terminal welcomeMessage="Welcome to TALight Desktop"
              prompt="talight$&nbsp;"></p-terminal>
          </div>
        </div>
      </ng-template>


      <ng-template pTemplate>
        <div class="console-widget-output">
          <!-- <div id="xterm-container"></div> -->
          <div class="console-widget-label">Output</div>
          <div class="console-widget-output-scroll" id="console-bottom-scroll">
            <pre class="console-widget-output-text" #output>{{outputText}}</pre>
          </div>
          <div class="console-widget-output-stdin">
            <button pButton class="p-button-danger" icon="pi pi-refresh" (click)="clearOutput()" title="Clear output"
              pTooltip="Pulisci output"></button>
            <input #sdtinInput class="console-widget-output-stdin-input" (keydown)="sendOnEnter($event)"
              placeholder="Input del programma" />
            <button pButton icon="pi pi-send" (click)="sendStdin()" title="Send" pTooltip="Invia"></button>
          </div>
        </div>
      </ng-template>

    </p-splitter>

</div>
